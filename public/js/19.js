(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{24:function(e,t,n){"use strict";var s=n(10),a=n.n(s);function r(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,(n=[{key:"get",value:function(e){return a.a.get("/api/data/users",e)}},{key:"getAll",value:function(e){return a.a.get("/api/users",e)}},{key:"show",value:function(e,t){return a.a.get("/api/users/".concat(e),t)}},{key:"store",value:function(e){return a.a.post("/api/users",e)}},{key:"update",value:function(e,t){return a.a.put("/api/users/".concat(e),t)}},{key:"delete",value:function(e,t){return a.a.delete("/api/users/".concat(e),t)}},{key:"restore",value:function(e,t){return a.a.put("/api/users/restore/".concat(e),t)}},{key:"updatePassword",value:function(e,t){return a.a.put("/api/users/update_password/".concat(e),t)}},{key:"resetPassword",value:function(e,t){return a.a.put("/api/users/reset_password/".concat(e),t)}},{key:"verifyEmail",value:function(e,t){return a.a.put("/api/users/verify_email/".concat(e),t)}},{key:"updateFund",value:function(e,t){return a.a.put("/api/users/update_fund/".concat(e),t)}},{key:"updateSettings",value:function(e,t){return a.a.put("/api/users/update_settings/".concat(e),t)}},{key:"updatePermissions",value:function(e,t){return a.a.put("/api/users/update_permissions/".concat(e),t)}},{key:"updateProfile",value:function(e,t){return a.a.put("/api/users/update_profile/".concat(e),t)}},{key:"updateActivation",value:function(e,t){return a.a.put("/api/users/update_activation/".concat(e),t)}},{key:"export",value:function(){return a.a.get("/api/users/export/data")}}])&&r(t.prototype,n),s&&r(t,s),e}();t.a=new o},28:function(e,t,n){"use strict";var s=n(24);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i={props:{selectedUsers:{type:Array,default:function(){return[]}},multipleSelection:{type:Boolean,default:!1},selectedUser:{type:Object,default:null},usersParameters:{type:Object,default:null}},data:function(){return{dialog:!1,loading:!1,collections:{selected:null,items:[]},filters:{search:""},options:{sortBy:["first_name"],sortDesc:[!1],page:1,itemsPerPage:10},meta:{current_page:0,from:0,last_page:0,path:"",per_page:"10",to:0,total:0}}},methods:{onSearch:function(){var e=this;this.getDataFromApi().then((function(t){e.collections.items=t.data,e.meta=t.meta}))},getDataFromApi:function(){var e=this;return this.loading=!0,new Promise((function(t,n){var a=e.options,o=a.sortBy,i=a.sortDesc,l=a.page,c=a.itemsPerPage,u={search:e.filters.search.trim().toLowerCase(),sortBy:o[0],sortType:i[0]?"desc":"asc",page:l,itemsPerPage:c,isSelection:!0,is_active:!0},p={};p=e.usersParameters&&e.usersParameters.params?{params:r(r({},u),e.usersParameters.params)}:{params:r({},u)},s.a.getAll(p).then((function(n){e.loading=!1,t(n.data)})).catch((function(t){e.mixin_showErrors(t),e.loading=!1,n()}))}))},onReset:function(){return this.dialog=!1,this.filters.search="",this.computedSelectedUser=null,this.options={sortBy:["last_name"],sortDesc:[!1],page:1,itemsPerPage:10},this.$emit("onReset",this.computedSelectedUser)},selectUser:function(e){this.computedSelectedUser=e,this.$emit("selectUser",e)},getJobName:function(e){return e.job?e.job.name:""},getDepartmentName:function(e){return e.job&&e.job.department?e.job.department.name:""}},watch:{"filters.search":function(){var e=this;""==this.filters.search&&this.getDataFromApi().then((function(t){e.collections.items=t.data,e.meta=t.meta}))},params:{handler:function(){var e=this;this.getDataFromApi().then((function(t){e.collections.items=t.data,e.meta=t.meta}))},deep:!0},dialog:function(){var e=this;this.getDataFromApi().then((function(t){e.collections.items=t.data,e.meta=t.meta}))}},computed:{params:function(e){return r({},this.options)},computedSelectedUser:{get:function(){return this.selectedUser?this.selectedUser:null},set:function(e){return e}}},created:function(){var e=this;this.getDataFromApi().then((function(t){e.collections.items=t.data,e.meta=t.meta}))}},l=n(4),c=Object(l.a)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[e._t("openDialog",null,null,{attrs:s,on:n,computedSelectedUser:e.computedSelectedUser})]}}],null,!0),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[e._v(" "),n("v-card",[n("v-card-title",[e._v("\n                Employees\n                "),n("v-spacer"),e._v(" "),n("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch(t)}},model:{value:e.filters.search,callback:function(t){e.$set(e.filters,"search",t)},expression:"filters.search"}})],1),e._v(" "),n("v-list",{staticClass:"overflow-y-auto",attrs:{"max-height":"400","two-line":""}},[n("v-list-item-group",{attrs:{"active-class":"green--text",multiple:e.multipleSelection},on:{change:e.selectUser},model:{value:e.computedSelectedUser,callback:function(t){e.computedSelectedUser=t},expression:"computedSelectedUser"}},[e._l(e.collections.items,(function(t,s){return[n("v-list-item",{key:s,attrs:{value:t}},[[n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:e._s(t.name)}}),e._v(" "),n("v-list-item-subtitle",{staticClass:"text--primary",domProps:{textContent:e._s(e.getJobName(t))}}),e._v(" "),n("v-list-item-subtitle",{domProps:{textContent:e._s(e.getDepartmentName(t))}})],1)]],2)]}))],2)],1),e._v(" "),n("div",[n("v-pagination",{attrs:{length:e.meta.last_page,"total-visible":7},model:{value:e.options.page,callback:function(t){e.$set(e.options,"page",t)},expression:"options.page"}})],1),e._v(" "),n("v-divider"),e._v(" "),n("v-card-actions",[n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.onReset}},[e._v("\n                    Reset\n                ")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("\n                    OK\n                ")])],1)],1)],1)],1)}),[],!1,null,null,null);t.a=c.exports},52:function(e,t,n){"use strict";var s=n(10),a=n.n(s);function r(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,(n=[{key:"getAll",value:function(e){return a.a.get("/api/expense_types",e)}},{key:"get",value:function(e){return a.a.get("/api/data/expense_types",e)}},{key:"show",value:function(e,t){return a.a.get("/api/expense_types/".concat(e),t)}},{key:"store",value:function(e){return a.a.post("/api/expense_types",e)}},{key:"update",value:function(e,t){return a.a.put("/api/expense_types/".concat(e),t)}},{key:"delete",value:function(e,t){return a.a.delete("/api/expense_types/".concat(e),t)}},{key:"restore",value:function(e,t){return a.a.put("/api/expense_types/restore/".concat(e),t)}}])&&r(t.prototype,n),s&&r(t,s),e}();t.a=new o},892:function(e,t,n){"use strict";n.r(t);var s=n(24),a=n(28),r=n(52),o={components:{UserDialogSelector:a.a},data:function(){return{formDataLoaded:!1,panel:[0],valid:!1,usersParameters:{params:{is_superadmin:!1,with_expense_types:!0}},user:null,headerExpenseTypes:[{text:"Name",value:"name"},{text:"Limit",value:"pivot.limit"}],sub_types:[],all_expense_types:[],allowed_expense_types:null,expense_types:[],expense_type:{id:null,sub_types:null,pivot:{limit:null}},pivot_expense_types:[],pivot_sub_types:null,collections:{},filters:{}}},methods:{onChangeUser:function(e){this.user=e},onResetUser:function(){this.user=null},loadExpenseTypes:function(){var e=this;return new Promise((function(t,n){r.a.getAll({params:{itemsPerPage:100}}).then((function(n){e.all_expense_types=n.data.data,e.formDataLoaded=!0,t()})).catch((function(t){e.mixin_showErrors(t),e.formDataLoaded=!0,n()}))}))},onSave:function(){var e=this;if(null!=this.user)if(this.$refs.form.validate(),this.$refs.form.validate()){this.loader=!0;var t={expense_types:this.allowed_expense_types.map((function(e){return e.id}))};s.a.updateSettings(this.user.id,t).then((function(t){e.mixin_successDialog(t.data.status,t.data.message),e.$store.dispatch("AUTH_USER")})).catch((function(t){e.mixin_showErrors(t),t.response&&t.response.data&&(e.errors=t.response.data.errors)}))}else;else this.mixin_errorDialog("Error","No user selected")}},watch:{user:function(e){this.allowed_expense_types=e?e.expense_types:null,this.pivot_expense_types=e?e.pivot_expense_types:null},allowed_expense_types:function(e){this.expense_types=e,this.sub_types=[]},expense_type:function(e){e.id;this.sub_types=this.pivot_sub_types}},computed:{expense_type_limit:{get:function(){return null==this.expense_type.pivot?null:this.expense_type.pivot.limit},set:function(e){return e}}},created:function(){this.loadExpenseTypes()},activated:function(){this.loadExpenseTypes()}},i=n(4),l=Object(i.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.formDataLoaded?n("v-card",{staticClass:"elevation-0"},[n("v-card-title",{staticClass:"pt-0"},[n("v-btn",{staticClass:"mr-3",attrs:{icon:""},on:{click:function(t){return e.$router.go(-1)}}},[n("v-icon",[e._v("mdi-arrow-left")])],1),e._v(" "),n("v-spacer"),e._v(" "),n("h4",{staticClass:"title success--text"},[e._v("Employee Settings")])],1),e._v(" "),n("v-card",{staticClass:"mb-4"},[n("v-card-text",[n("v-row",[n("v-col",{attrs:{cols:"12",md:"6"}},[n("UserDialogSelector",{ref:"userDialogSelector",attrs:{selectedUser:e.user,usersParameters:e.usersParameters},on:{selectUser:e.onChangeUser,onReset:e.onResetUser},scopedSlots:e._u([{key:"openDialog",fn:function(t){var s=t.bind,a=t.on,r=t.computedSelectedUser;return[n("v-btn",e._g(e._b({},"v-btn",s,!1),a),[e._v("\n                                    "+e._s(r?r.name:"Select Employee")+"\n                                ")])]}}]),model:{value:e.user,callback:function(t){e.user=t},expression:"user"}})],1)],1)],1)],1),e._v(" "),n("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-expansion-panels",{attrs:{multiple:""},model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},[n("v-expansion-panel",[n("v-expansion-panel-header",[n("div",{staticClass:"green--text"},[e._v("\n                            Expense Types\n                        ")])]),e._v(" "),n("v-expansion-panel-content",[n("v-row",[n("v-col",{attrs:{cols:"12",md:"4"}},[n("v-select",{attrs:{items:e.all_expense_types,"item-text":"name","item-value":"id","return-object":"",label:"Allowed Expense Types",multiple:""},scopedSlots:e._u([{key:"selection",fn:function(t){var s=t.item,a=t.index;return[0===a?n("v-chip",{attrs:{small:""}},[n("span",[e._v(e._s(s.name))])]):e._e(),e._v(" "),1===a?n("span",{staticClass:"grey--text caption"},[e._v("(+"+e._s(e.allowed_expense_types.length-1)+"\n                                            others)")]):e._e()]}}]),model:{value:e.allowed_expense_types,callback:function(t){e.allowed_expense_types=t},expression:"allowed_expense_types"}})],1)],1),e._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12",md:"4"}},[n("v-btn",{attrs:{color:"green",dark:""},on:{click:e.onSave}},[e._v("\n                                    Save Changes\n                                ")])],1)],1)],1)],1)],1)],1)],1):n("loader-component")],1)}),[],!1,null,null,null);t.default=l.exports}}]);