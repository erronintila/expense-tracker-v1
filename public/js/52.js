(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{882:function(e,r,t){"use strict";t.r(r);t(1),t(50);var n=t(162),s=t(163),a=t(28),o=t(38),i={components:{AddVendor:s.a,UserDialogSelector:a.a,Form:n.a},data:function(){return{formDataLoaded:!1,usersParameters:{params:{with_expense_types:!0}},items:[],itemize:!1,form:{code:null,description:null,amount:0,details_quantity:0,details_amount:0,receipt_number:null,date:null,remarks:"",is_active:!0,expense_type:null,sub_type:null,user:null,vendor:null,is_reimbursable:!1,revolving_fund:0,reimbursable_amount:0,details:[],is_tax_inclusive:!0,tax_name:"",tax_rate:0,tax_amount:0},rules:{reimbursable_amount:[],revolving_fund:[]},errors:{sub_type:[],description:[],amount:[],reimbursable_amount:[],receipt_number:[],date:[],remarks:[],is_active:[],expense_type_id:[],user_id:[],vendor_id:[]}}},methods:{getData:function(){var e=this;return new Promise((function(r,t){o.a.show(e.$route.params.id).then((function(t){var n,s=t.data.data;e.form.code=s.code,e.form.description=s.description,e.form.receipt_number=s.receipt_number,e.form.date=s.date,e.form.remarks=s.remarks,e.form.is_active=s.is_active,e.form.user=s.user,e.form.vendor=s.vendor,e.form.expense_type=s.expense_type,e.expense_types=s.user.expense_types,e.sub_types=s.expense_type.sub_types,e.form.is_tax_inclusive=s.is_tax_inclusive,e.form.tax_name=s.tax_name,e.form.tax_rate=s.tax_rate,e.form.tax_amount=s.tax_amount,e.form.details=null!==(n=s.details)&&void 0!==n?n:[],s.details&&s.details.length?(e.itemize=!0,e.items=s.details):e.form.amount=s.amount,e.sub_types.unshift({id:null,name:"None",limit:null}),e.form.sub_type=null==s.sub_type?{id:null,name:"None",limit:null}:s.sub_type,s.revolving_fund>0?e.form.revolving_fund=s.revolving_fund:e.form.revolving_fund=0,e.form.reimbursable_amount=s.reimbursable_amount,e.form.user.remaining_fund+=s.amount-s.reimbursable_amount,e.formDataLoaded=!0,r()})).catch((function(r){e.mixin_showErrors(r),e.formDataLoaded=!0,e.$router.push({name:"user.expenses.index"},(function(){})),t()}))}))},selectUser:function(e){this.errors.user_id=[],this.form.user=null!=e&&null!=e?e:null},resetUser:function(){this.form.user=null},onSave:function(e){var r=this;e.vendor&&(e.vendor.is_vat_inclusive||(e.tax_rate=0,e.tax_amount=0)),e.details=e.itemize?e.items:null,e.expense_type_id=e.expense_type?e.expense_type.id:null,e.sub_type_id=e.sub_type?e.sub_type.id:null,e.user_id=e.user?e.user.id:null,e.vendor_id=e.vendor?e.vendor.id:null,e.reimbursable_amount=e.amount_to_reimburse,o.a.update(this.$route.params.id,e).then((function(e){r.mixin_successDialog(e.data.status,e.data.message),r.$router.go(-1),r.formDataLoaded=!0})).catch((function(e){r.mixin_showErrors(e),null!==e.response.data.data&&(r.errors=e.response.data.errors),r.formDataLoaded=!0}))}},created:function(){this.getData().then(this.formDataLoaded=!0)}},u=t(4),l=Object(u.a)(i,(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[e.formDataLoaded?t("v-card",{staticClass:"elevation-0 pt-0"},[t("v-card-title",{staticClass:"pt-0"},[t("v-btn",{staticClass:"mr-3",attrs:{icon:""},on:{click:function(r){return e.$router.go(-1)}}},[t("v-icon",[e._v("mdi-arrow-left")])],1),e._v(" "),t("v-spacer"),e._v(" "),t("h4",{staticClass:"title green--text"},[e._v("Edit Expense")])],1),e._v(" "),t("v-container",[e.formDataLoaded?t("Form",{attrs:{itemizeExpenses:e.itemize,expenseForm:e.form,errors:e.errors,rules:e.rules},on:{"on-save":e.onSave},scopedSlots:e._u([{key:"userSelector",fn:function(){return[t("v-row",[t("v-col",[t("v-text-field",{attrs:{value:e.form.user?e.form.user.full_name:"No Employee","error-messages":e.errors.user_id,label:"Employee",readonly:""},on:{input:function(r){e.errors.user_id=[]}},scopedSlots:e._u([e.mixin_can("select specific users on expenses")?{key:"append",fn:function(){return[t("UserDialogSelector",{ref:"userDialogSelector",attrs:{selectedUser:e.form.user,usersParameters:e.usersParameters},on:{selectUser:e.selectUser,onReset:e.resetUser},scopedSlots:e._u([{key:"openDialog",fn:function(r){var n=r.bind,s=r.on;return[t("v-btn",e._g(e._b({attrs:{fab:"",color:"primary",text:"","x-small":""}},"v-btn",n,!1),s),[t("v-icon",{attrs:{dark:""}},[e._v("mdi-magnify")])],1)]}}],null,!1,2729772431)})]},proxy:!0}:null],null,!0)})],1)],1)]},proxy:!0}],null,!1,2795644674)}):e._e()],1)],1):t("loader-component")],1)}),[],!1,null,null,null);r.default=l.exports}}]);