(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{886:function(e,r,t){"use strict";t.r(r);var s=t(1),o=t.n(s),n=t(161),a=t(41),i=t(38),u={components:{UserDialogSelector:t(28).a,Form:n.a},data:function(){return{loader:!0,formDataLoaded:!1,usersParameters:{params:{is_superadmin:!1}},expense_report_id:parseInt(this.$route.params.id),form:{code:"",description:"",remarks:"",notes:"",user:this.$store.getters.user.is_admin?null:this.$store.getters.user,expenses:[],status:null,from:"",to:""},errors:{date_range:[],code:[],description:[],remarks:[],notes:[],user_id:[],expenses:[]},rules:{}}},methods:{selectUser:function(e){this.form.user=null!=e&&null!=e?e:null},resetUser:function(){this.form.user=null},getData:function(){var e=this;return new Promise((function(r,t){a.a.show(e.$route.params.id).then((function(t){e.loader=!1,r(t.data.data)})).catch((function(r){e.mixin_showErrors(r),e.loader=!1,e.$router.push({name:"user.expense_reports.index"},(function(){})),t()}))}))},loadExpenses:function(e){var r=this;return new Promise((function(t,s){i.a.get({params:{update_report:!0,user_id:e.user?e.user.id:null,start_date:e.from,end_date:o()().endOf().format("YYYY-MM-DD"),expense_report_id:r.$route.params.id}}).then((function(e){r.loader=!1,t(e.data.data)})).catch((function(e){r.mixin_showErrors(e),r.loader=!1,s()}))}))},onSave:function(e){var r=this;this.loader=!0,e.user_id=e.user?e.user.id:null,a.a.update(this.$route.params.id,e).then((function(e){r.mixin_successDialog(e.data.status,e.data.message),r.$router.push({name:"user.expense_reports.index"}),r.loader=!1})).catch((function(e){r.mixin_showErrors(e),r.errors=e.response.data.errors,r.loader=!1}))}},created:function(){var e=this;this.getData().then((function(r){e.loadExpenses(r).then((function(t){e.form=r,e.form.expenses=t,e.formDataLoaded=!0}))}))}},l=t(4),d=Object(l.a)(u,(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[e.formDataLoaded?t("v-card",{staticClass:"elevation-0 pt-0"},[t("v-card-title",{staticClass:"pt-0"},[t("v-btn",{staticClass:"mr-3",attrs:{icon:""},on:{click:function(r){return e.$router.go(-1)}}},[t("v-icon",[e._v("mdi-arrow-left")])],1),e._v(" "),t("v-spacer"),e._v(" "),t("h4",{staticClass:"title green--text"},[e._v("Edit Expense Report")])],1),e._v(" "),t("v-container",[e.formDataLoaded?t("Form",{attrs:{expenseReportForm:e.form,expenseReportErrors:e.errors,expenseReportRules:e.rules,expense_report_id:e.expense_report_id},on:{"on-save":e.onSave},scopedSlots:e._u([{key:"userSelector",fn:function(){return[t("v-row",[t("v-col",[t("v-text-field",{attrs:{value:e.form.user?e.form.user.full_name:"No Employee","error-messages":e.errors.user_id,label:"Employee",readonly:""},on:{input:function(r){e.errors.user_id=[]}},scopedSlots:e._u([e.mixin_can("select specific users on expense reports")?{key:"append",fn:function(){return[t("UserDialogSelector",{ref:"userDialogSelector",attrs:{selectedUser:e.form.user,usersParameters:e.usersParameters},on:{selectUser:e.selectUser,onReset:e.resetUser},scopedSlots:e._u([{key:"openDialog",fn:function(r){var s=r.bind,o=r.on;return[t("v-btn",e._g(e._b({attrs:{fab:"",color:"primary",text:"","x-small":""}},"v-btn",s,!1),o),[t("v-icon",{attrs:{dark:""}},[e._v("mdi-magnify")])],1)]}}],null,!1,2729772431)})]},proxy:!0}:null],null,!0)})],1)],1)]},proxy:!0}],null,!1,2894676940)}):e._e()],1)],1):t("loader-component")],1)}),[],!1,null,null,null);r.default=d.exports}}]);